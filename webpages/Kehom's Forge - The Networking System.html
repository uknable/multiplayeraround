<!DOCTYPE html>
<!-- saved from url=(0065)http://kehomsforge.com/tutorials/multi/gdMultiplayerSetup/part01/ -->
<html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
   
   <title>Kehom's Forge - The Networking System</title>

   <link rel="stylesheet" type="text/css" href="./Kehom&#39;s Forge - The Networking System_files/main.css">
   <link rel="stylesheet" type="text/css" href="./Kehom&#39;s Forge - The Networking System_files/prism.css">
   <link rel="stylesheet" type="text/css" href="./Kehom&#39;s Forge - The Networking System_files/katex.min.css">
   <script src="./Kehom&#39;s Forge - The Networking System_files/jquery-3.3.1.min.js.download"></script>
   <script src="./Kehom&#39;s Forge - The Networking System_files/progress_bar.js.download"></script>
   <script src="./Kehom&#39;s Forge - The Networking System_files/audio_player.js.download"></script>
   <script src="./Kehom&#39;s Forge - The Networking System_files/main.js.download"></script></head>
<body>

<div class="page-container">

   <div class="header">
      <a href="http://kehomsforge.com/"><img src="./Kehom&#39;s Forge - The Networking System_files/title_anvil.png" style="margin: 0; padding: 0"><img src="./Kehom&#39;s Forge - The Networking System_files/title.png" style="margin: 0; padding: 0"></a>
   </div>

   <div class="col-container clearfix">
      <div class="column sidebar sidenav">
         <a href="http://kehomsforge.com/" class="">Home</a>
         <a href="http://kehomsforge.com/tutorials" class="active">Tutorials</a>
         <a href="http://kehomsforge.com/blog/1/" class="">Blog</a>
         <a href="http://kehomsforge.com/news/1/" class="">News</a>
         <a href="http://kehomsforge.com/contact" class="">Contact</a>
         <a href="http://kehomsforge.com/about" class="">About</a>
         <hr>
      
         <button class="acc_button">
            <img src="./Kehom&#39;s Forge - The Networking System_files/feed-icon.svg" style="width: 16px; height: 16px; vertical-align: middle;" onerror="this.src=\" feed-icon.png\';'="">
            <span style="">RSS</span>
         </button>
         <div class="acc_panel">
            <a href="http://kehomsforge.com/newsfeed.xml">News</a>
            <a href="http://kehomsforge.com/blogfeed.xml">Blog</a>
            <a href="http://kehomsforge.com/allfeed.xml">News + Blog</a>
         </div>
      
      
      </div>
      

      <div class="column content">
         
         <h2>Part 1 - The Networking System and Project Setup</h2>
<p>In this part we will first get a really brief overview of the networking system provided by Godot and then get the initial project setup so in the next parts we can directly work on the desired functionality.</p>
<h3>Godot Networking</h3>
<p>Godot’s networking documentation can be found <a href="https://docs.godotengine.org/en/3.1/tutorials/networking/index.html">here</a> but as you can see, it is split into <em>high level</em> and several pages dedicated to HTTP. We will focus on the <em>high level</em> section. There is a lot of important information there, so take some time to read it. Yes, I know, not everyone will be able to use that information to put networking use in practice. That’s the main reason this tutorial exists!</p>
<p>Nevertheless, the entire system relies on the <code class="">NetworkedMultiplayerENet</code> class. We use it to create either a server or a client. Once a connection is established, we can create some special functions that are meant to be executed in a remote machine. For that, we declare a function (in GDScript) like this:</p>
<pre class="language-python line-numbers"><code class="language-python">remote func function_name<span class="token punctuation">(</span>arguments<span class="token punctuation">)</span><span class="token punctuation">:</span>
   function code
<span class="line-numbers-rows" aria-hidden="true"><span></span><span></span></span></code></pre>
<p>While those can be called locally, we also want those to work on a remote machine, which requires us to call then through the use of <em>remote procedure calls</em> (RPCs). More specifically, we do this by using one of the four rpc* functions provided by Godot.</p>
<ul>
<li><code class="">rpc()</code> → Calls the specified remote function on all connected peers and locally. But, there is one thing to keep in mind, it never calls the function on the server.</li>
<li><code class="">rpc_id()</code> → With this we can call a remote function on the specified machine, based on it’s ID. We have just to take care to not use this specifying the local ID.</li>
<li><code class="">rpc_unreliable()</code> → This works very similarly to the <code class="">rpc()</code>, but using the unreliable but faster protocol.</li>
<li><code class="">rpc_unreliable_id()</code> → And we can also use the faster protocol to request a remote function call in the specified connected machine.</li>
</ul>
<p>Ok, with those we can call functions on different machines. While we can use then to keep member variables in sync, we have some functions that are meant exactly for that! To use those functions, we have to declare the variables like this:</p>
<pre class="language-python line-numbers"><code class="language-python">slave var variable_name
<span class="line-numbers-rows" aria-hidden="true"><span></span></span></code></pre>
<p>Then, the four functions to sync those variables:</p>
<ul>
<li><code class="">rset()</code> → Changes the variable value on all connected peers and locally. Again, keep in mind that it does not set the value on the server.</li>
<li><code class="">rset_id()</code> → Does the same of <code class="">rset()</code> but only on the specified connected machine based on it’s ID.</li>
<li><code class="">rset_unreliable()</code> → Uses the faster protocol to change the variable on the connected peers.</li>
<li><code class="">rset_unreliable_id()</code> → The faster protocol is used to set the variable on the specified remote machine.</li>
</ul>
<p>That’s pretty much it for the networking system! Don’t worry if it seems rushed and/or confusing. I did rush a bit mostly because this information is presented in the documentation and I doubt I will be able to bring something extra regarding the API itself. Anyway, this tutorial is meant to show how to put the networking system in practice.</p>
<p>Actually there is more to the behavior of RPC and RSET functions. What was described is the default when a function is marked as <code class="">remote</code> and called through remote calls, however that behavior can be changed through the <code class="">RPCMode</code>, which can be set with <code class="">rpc_config()</code> function. I won’t go into much details about this because this tutorial is meant to be very basic. Just know that there is more to it than the text in here.</p>
<h3>Project Setup</h3>
<p>Before we can see how to use the networking API we first need to create the Godot project and do some initial setup to work with. That said, open Godot and create a new project. This first scene will be used to hold the “main menu”, so choose <code class="">CanvasLayer</code> as the root node type. Save the scene as <code class="">main_menu.tscn</code>. Please note that whenever I create files I strictly use lower case in order to ensure there won’t be problems across systems. The thing is, Linux is case sensitive when dealing with files and paths.</p>
<p>Now open the project settings and in the <em>Application → Run</em> category set the <code class="">Main Scene</code> property to be the <code class="">main_menu.tscn</code>.</p>
<p>Next we create a new scene that will be used as the “game world”. So, choose <code class="">2D Scene</code> (Node2D) as root node type then save it as <code class="">game_world.tscn</code>.</p>
<p>We will use Godot <a href="https://docs.godotengine.org/en/3.1/getting_started/step_by_step/singletons_autoload.html">singletons</a> to hold our networking code and game state as well as some other information. We will split some of those into two different files. I wont go into much details here, but this splitting is mostly to keep networking code separated from some other things that may be used with other systems unrelated to networking. That said, create two empty script files, <code class="">gamestate.gd</code> and <code class="">network.gd</code>, both extending <code class="">Node</code>. For the moment, the only thing in each file should be a single line:</p>
<pre class="language-none line-numbers"><code class="">extends Node
<span class="line-numbers-rows" aria-hidden="true"><span></span></span></code></pre>
<p>Open the project settings window again and then, on the top section choose the <code class="">AutoLoad</code> tab in order to add the <code class="">gamestate.gd</code> and <code class="">network.gd</code> files to be singletons:</p>
<div class="centerblock">
<img src="./Kehom&#39;s Forge - The Networking System_files/01-autoload.png" class="thumbnail can-zoom" alt="Autoload">
</div>
<hr>
<p>In this rather short part we did see the networking system that is provided by Godot just mentioning what each thing do. Later we created the initial project structure so in the next part we can put the information into practice.</p>
<p>EDIT: Thanks to menip for pointing out a typo and a mistake.</p>


         <hr>
         <div class="centerblock">
            <a href="http://kehomsforge.com/tutorials/multi/gdMultiplayerSetup">Introduction</a><br>

            


               <p class="bottomnav">01</p>
               <a href="http://kehomsforge.com/tutorials/multi/gdMultiplayerSetup/part02" class="bottomnav">02</a>
               <a href="http://kehomsforge.com/tutorials/multi/gdMultiplayerSetup/part03" class="bottomnav">03</a>
               <a href="http://kehomsforge.com/tutorials/multi/gdMultiplayerSetup/part04" class="bottomnav">04</a>

               <a href="http://kehomsforge.com/tutorials/multi/gdMultiplayerSetup/part02">Next</a>

         </div>

      </div>
   </div>

   <div class="footer">
      ...
   </div>
</div>



</body></html>